restart_home_assistant:
  alias: Restart Home Assistant
  sequence:
    service: homeassistant.restart
rewind_living_room_tv:
  alias: Rewind Living Room TV
  sequence:
  - condition: template
    value_template: '{{ "media_position" in states.media_player.living_room_tv.attributes
      }}'
  - service: media_player.media_seek
    entity_id: media_player.living_room_tv
    data_template:
      seek_position: "{% set pos = states.media_player.living_room_tv.attributes.media_position\
        \ %} {{ (pos-30, 0)|max }}  \n"
fast_forward_living_room_tv:
  alias: Fast Forward Living Room TV
  sequence:
  - condition: template
    value_template: '{{ "media_position" in states.media_player.living_room_tv.attributes
      and "media_duration" in states.media_player.living_room_tv.attributes}}'
  - service: media_player.media_seek
    entity_id: media_player.living_room_tv
    data_template:
      seek_position: "{% set pos = states.media_player.living_room_tv.attributes.media_position\
        \ %} {% set end = states.media_player.living_room_tv.attributes.media_duration\
        \ %} {{ (pos+30, end)|min }}   \n"
notify_patrick:
  alias: Notify Patrick
  sequence:
  - data:
      Message: Hello from HA
    data_template:
      message: Home Assistant says hi
    service: notify.mobile_app_galaxy_s10
notify_lg_tv_call:
  alias: Notify LG TV call
  sequence:
  - service: notify.lg_tv
    data_template:
      message: '{{message}}'
      data:
        icon: /config/www/images/phone.png
notify_lg_tv_cam:
  alias: Notify LG TV cam
  sequence:
  - service: notify.lg_tv
    data:
      message: Motion detected on front porch
      data:
        icon: /config/www/images/snapshot_cam_2.jpg
notify_liz_phone_cam:
  alias: Notify Liz Phone cam
  sequence:
  - data_template:
      data:
        attachment:
          hide-thumbnail: false
          url: https://twosquaredlove.duckdns.org/local/images/snapshot_cam_{{channel_number}}.jpg?{{now().strftime("%s")}}.jpg
      title: '{{message}}'
      message: '{{timestamp}}'
    service: notify.mobile_app_liz_cartons_iphone
notify_patrick_phone_cam:
  alias: Notify Patrick Phone cam
  sequence:
  - data_template:
      data:
        image: https://twosquaredlove.duckdns.org/local/images/snapshot_cam_{{channel_number}}.jpg?{{now().strftime("%s")}}.jpg
        clickAction: https://www.dropbox.com/home/Apps/DVR163/ch{{channel_number}}?file={{file_name}}.jpg
        sticky: false
        channel: Motion cam {{channel_number}}
      title: '{{message}}'
      message: '{{timestamp}}'
    service: notify.mobile_app_galaxy_s10
notify_pushbullet_cam:
  alias: Notify Pushbullet cam
  sequence:
  - data_template:
      data:
        file_url: https://twosquaredlove.duckdns.org/local/images/snapshot_cam_{{channel_number}}.jpg?{{now().strftime("%s")}}.jpg
      title: '{{message}}'
      message: '{{timestamp}} {{now}}'
    service: notify.pushbullet
motion_detected_notifications:
  alias: Motion detected notifications
  sequence:
  - service: shell_command.snapshot_to_disk
    data_template:
      image_data: '{{image_data}}'
      channel_number: '{{channel_number}}'
  - condition: template
    value_template: '{{ is_state("timer.disable_cams", "idle") and is_state("input_boolean.cam_" ~ channel_number ~ "_notify", "on") }}'
  - service: script.notify_lg_tv_cam
  - service: script.notify_liz_phone_cam
    data_template:
      timestamp: '{{timestamp}}'
      message: '{{timestamp}}'
      channel_number: '{{channel_number}}'
  - service: script.notify_patrick_phone_cam
    data_template:
      channel_number: '{{channel_number}}'
      file_name: '{{file_name}}'
      message: '{{message}}'
      timestamp: '{{timestamp}}'
  # - service: script.notify_pushbullet_cam
  #   data_template:
  #     timestamp: '{{timestamp}}'      
  #     message: '{{timestamp}}'      
  #     channel_number: '{{channel_number}}'      
talk:
  alias: TTS Example
  sequence:
  - service: tts.google_say
    entity_id: media_player.living_room_speaker
    data:
      message: Hello Liz
cam_2_snapshot:
  alias: Cam 2 snapshot
  sequence:
  - data: {}
    service: shell_command.cam_2_snapshot
